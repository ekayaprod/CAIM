<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CA Identity Manager Bookmarklets</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .content {
            padding: 40px;
        }
        
        .bookmarklet-section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .bookmarklet-section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .bookmarklet-section p {
            color: #6c757d;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .bookmarklet-link {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.95rem;
            margin: 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .bookmarklet-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            text-decoration: none;
            color: white;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 15px 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        
        .instructions {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .instructions h3 {
            color: #0d47a1;
            margin-bottom: 15px;
        }
        
        .instructions ol {
            color: #1565c0;
            margin-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .warning {
            background: #fff3e0;
            border: 1px solid #ff9800;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #e65100;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>CA Identity Manager Bookmarklets</h1>
            <p>Browser-based tools for CA IM administration</p>
        </div>
        
        <div class="content">
            <div class="instructions">
                <h3>üìã How to Install Bookmarklets</h3>
                <ol>
                    <li>Right-click on any bookmarklet link below</li>
                    <li>Select "Add to Bookmarks" or "Bookmark this link"</li>
                    <li>Navigate to your CA Identity Manager admin portal</li>
                    <li>Click the bookmarklet from your bookmarks bar to run it</li>
                </ol>
            </div>

            <div class="warning">
                <strong>‚ö†Ô∏è Important:</strong> These bookmarklets need to be customized for your specific CA IM interface. They provide a starting framework that you'll need to adapt to your system's HTML structure and URLs.
            </div>

            <div class="bookmarklet-section">
                <h2>üîç User Search Helper</h2>
                <p>Adds a floating search box that can quickly search for users and highlight them on the page.</p>
                <a href="javascript:(function(){var d=document,s=d.createElement('div');s.innerHTML='<div style=\"position:fixed;top:10px;right:10px;background:white;border:2px solid #667eea;border-radius:10px;padding:15px;z-index:10000;box-shadow:0 4px 20px rgba(0,0,0,0.3);font-family:Arial,sans-serif;\"><h4 style=\"margin:0 0 10px 0;color:#2c3e50;\">üîç User Search</h4><input type=\"text\" id=\"userSearchInput\" placeholder=\"Enter username\" style=\"width:200px;padding:8px;border:1px solid #ccc;border-radius:5px;margin-bottom:10px;\"><br><button onclick=\"searchUsers()\" style=\"background:#667eea;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin-right:5px;\">Search</button><button onclick=\"clearHighlights()\" style=\"background:#95a5a6;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;\">Clear</button><button onclick=\"this.parentNode.parentNode.remove()\" style=\"background:#e74c3c;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin-left:5px;\">√ó</button></div>';d.body.appendChild(s);window.searchUsers=function(){var term=d.getElementById('userSearchInput').value.toLowerCase();if(!term)return;clearHighlights();var walker=d.createTreeWalker(d.body,NodeFilter.SHOW_TEXT,null,false);var node;while(node=walker.nextNode()){if(node.textContent.toLowerCase().includes(term)){var span=d.createElement('span');span.style.backgroundColor='#ffeb3b';span.style.padding='2px 4px';span.style.borderRadius='3px';span.className='userSearchHighlight';span.textContent=node.textContent;node.parentNode.replaceChild(span,node);}}};window.clearHighlights=function(){var highlights=d.querySelectorAll('.userSearchHighlight');highlights.forEach(function(el){var text=d.createTextNode(el.textContent);el.parentNode.replaceChild(text,el);});};})();" class="bookmarklet-link">User Search Helper</a>
            </div>

            <div class="bookmarklet-section">
                <h2>üìã Bulk Action Form</h2>
                <p>Creates a form for entering multiple usernames and generates action lists for bulk operations.</p>
                <a href="javascript:(function(){var d=document,f=d.createElement('div');f.innerHTML='<div style=\"position:fixed;top:50px;left:50px;width:400px;background:white;border:2px solid #667eea;border-radius:10px;padding:20px;z-index:10000;box-shadow:0 4px 20px rgba(0,0,0,0.3);font-family:Arial,sans-serif;\"><h3 style=\"margin:0 0 15px 0;color:#2c3e50;\">üìã Bulk Actions</h3><textarea id=\"bulkUsers\" placeholder=\"Enter usernames, one per line\" style=\"width:100%;height:100px;padding:8px;border:1px solid #ccc;border-radius:5px;margin-bottom:10px;font-family:monospace;\"></textarea><select id=\"bulkAction\" style=\"width:100%;padding:8px;border:1px solid #ccc;border-radius:5px;margin-bottom:10px;\"><option value=\"unlock\">Unlock Accounts</option><option value=\"reset\">Reset Passwords</option><option value=\"both\">Unlock & Reset</option></select><button onclick=\"generateBulkList()\" style=\"background:#667eea;color:white;border:none;padding:10px 15px;border-radius:5px;cursor:pointer;margin-right:5px;\">Generate List</button><button onclick=\"this.parentNode.remove()\" style=\"background:#e74c3c;color:white;border:none;padding:10px 15px;border-radius:5px;cursor:pointer;\">Close</button><div id=\"bulkResults\" style=\"margin-top:15px;max-height:200px;overflow-y:auto;\"></div></div>';d.body.appendChild(f);window.generateBulkList=function(){var users=d.getElementById('bulkUsers').value.split('\\n').filter(u=>u.trim());var action=d.getElementById('bulkAction').value;var results=d.getElementById('bulkResults');if(users.length===0){results.innerHTML='<p style=\"color:red;\">Please enter at least one username.</p>';return;}var html='<h4>Action Plan:</h4><ul>';users.forEach((user,i)=>{user=user.trim();if(user){html+=`<li><strong>${user}</strong>`;if(action==='unlock'||action==='both')html+=' ‚Üí Unlock';if(action==='reset'||action==='both')html+=' ‚Üí Reset Password';html+='</li>';}});html+='</ul><p><small>Copy this list and work through each user in CA IM.</small></p>';results.innerHTML=html;};})();" class="bookmarklet-link">Bulk Action Form</a>
            </div>

            <div class="bookmarklet-section">
                <h2>üîê Password Expiry Checker</h2>
                <p>Scans the current page for password expiry information and highlights users with expiring passwords.</p>
                <a href="javascript:(function(){var d=document,c=d.createElement('div');c.innerHTML='<div style=\"position:fixed;bottom:10px;right:10px;background:white;border:2px solid #f39c12;border-radius:10px;padding:15px;z-index:10000;box-shadow:0 4px 20px rgba(0,0,0,0.3);font-family:Arial,sans-serif;max-width:300px;\"><h4 style=\"margin:0 0 10px 0;color:#e67e22;\">üîê Password Expiry Scan</h4><button onclick=\"scanPasswordExpiry()\" style=\"background:#f39c12;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin-right:5px;\">Scan Page</button><button onclick=\"this.parentNode.remove()\" style=\"background:#e74c3c;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;\">√ó</button><div id=\"expiryScanResults\" style=\"margin-top:10px;font-size:12px;\"></div></div>';d.body.appendChild(c);window.scanPasswordExpiry=function(){var results=d.getElementById('expiryScanResults');var dateRegex=/\\b(\\d{1,2}[\\/\\-]\\d{1,2}[\\/\\-]\\d{2,4})\\b/g;var today=new Date();var thirtyDaysOut=new Date(today.getTime()+30*24*60*60*1000);var walker=d.createTreeWalker(d.body,NodeFilter.SHOW_TEXT,null,false);var node;var findings=[];while(node=walker.nextNode()){var matches=node.textContent.match(dateRegex);if(matches){matches.forEach(match=>{try{var date=new Date(match);if(date>today&&date<=thirtyDaysOut){var span=d.createElement('span');span.style.backgroundColor='#ffeb3b';span.style.border='2px solid #f39c12';span.style.padding='2px 4px';span.style.borderRadius='3px';span.className='expiryHighlight';span.textContent=node.textContent;node.parentNode.replaceChild(span,node);findings.push(`Found expiring date: ${match}`);}}catch(e){}});}}if(findings.length>0){results.innerHTML=`<strong>Found ${findings.length} potential expiry dates</strong><br>${findings.slice(0,5).join('<br>')}`;}else{results.innerHTML='No expiring dates found on this page.';}};})();" class="bookmarklet-link">Password Expiry Checker</a>
            </div>

            <div class="bookmarklet-section">
                <h2>üìä Page Data Extractor</h2>
                <p>Extracts user data from tables and lists on the current page and formats it for export.</p>
                <a href="javascript:(function(){var d=document,e=d.createElement('div');e.innerHTML='<div style=\"position:fixed;top:10px;left:10px;width:500px;background:white;border:2px solid #27ae60;border-radius:10px;padding:20px;z-index:10000;box-shadow:0 4px 20px rgba(0,0,0,0.3);font-family:Arial,sans-serif;\"><h3 style=\"margin:0 0 15px 0;color:#27ae60;\">üìä Data Extractor</h3><button onclick=\"extractTableData()\" style=\"background:#27ae60;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin:5px;\">Extract Tables</button><button onclick=\"extractUserData()\" style=\"background:#3498db;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin:5px;\">Find User Data</button><button onclick=\"this.parentNode.remove()\" style=\"background:#e74c3c;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin:5px;\">Close</button><div id=\"extractResults\" style=\"margin-top:15px;max-height:300px;overflow-y:auto;background:#f8f9fa;padding:10px;border-radius:5px;font-family:monospace;font-size:11px;\"></div></div>';d.body.appendChild(e);window.extractTableData=function(){var tables=d.querySelectorAll('table');var results=d.getElementById('extractResults');var output='';tables.forEach((table,i)=>{output+=`\\nTable ${i+1}:\\n`;var rows=table.querySelectorAll('tr');rows.forEach((row,j)=>{var cells=row.querySelectorAll('td,th');var rowData=[];cells.forEach(cell=>rowData.push(cell.textContent.trim()));if(rowData.length>0)output+=rowData.join(' | ')+'\\n';});});results.textContent=output||'No tables found';};window.extractUserData=function(){var results=d.getElementById('extractResults');var userPatterns=[/\b[a-z]{2,8}\d{0,4}\b/gi,/\b\w+@\w+\.\w+\b/gi,/\b[A-Z][a-z]+ [A-Z][a-z]+\b/g];var findings=new Set();userPatterns.forEach(pattern=>{var walker=d.createTreeWalker(d.body,NodeFilter.SHOW_TEXT,null,false);var node;while(node=walker.nextNode()){var matches=node.textContent.match(pattern);if(matches){matches.forEach(match=>findings.add(match.trim()));}}});var output='Found potential user data:\n';Array.from(findings).slice(0,50).forEach(item=>output+=item+'\n');results.textContent=output;};})();" class="bookmarklet-link">Page Data Extractor</a>
            </div>

            <div class="bookmarklet-section">
                <h2>‚ö° Quick Actions Panel</h2>
                <p>Creates a floating panel with quick action buttons for common CA IM tasks.</p>
                <a href="javascript:(function(){if(document.getElementById('caim-panel'))return;var d=document,p=d.createElement('div');p.id='caim-panel';p.innerHTML='<div style=\"position:fixed;top:50%;left:10px;transform:translateY(-50%);background:white;border:2px solid #9b59b6;border-radius:15px;padding:20px;z-index:10000;box-shadow:0 10px 30px rgba(0,0,0,0.3);font-family:Arial,sans-serif;width:200px;\"><h4 style=\"margin:0 0 15px 0;color:#8e44ad;text-align:center;\">‚ö° Quick Actions</h4><div style=\"display:flex;flex-direction:column;gap:8px;\"><button onclick=\"highlightForms()\" style=\"background:#3498db;color:white;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;font-size:12px;\">Highlight Forms</button><button onclick=\"showPageInfo()\" style=\"background:#e67e22;color:white;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;font-size:12px;\">Page Info</button><button onclick=\"findButtons()\" style=\"background:#27ae60;color:white;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;font-size:12px;\">Find Buttons</button><button onclick=\"exportPageData()\" style=\"background:#f39c12;color:white;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;font-size:12px;\">Export Data</button><button onclick=\"document.getElementById(\\'caim-panel\\').remove()\" style=\"background:#e74c3c;color:white;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;font-size:12px;margin-top:10px;\">Close</button></div></div>';d.body.appendChild(p);window.highlightForms=function(){d.querySelectorAll('form,input,select,textarea').forEach(el=>{el.style.outline='3px solid #e74c3c';el.style.backgroundColor='rgba(231,76,60,0.1)';});setTimeout(()=>d.querySelectorAll('form,input,select,textarea').forEach(el=>{el.style.outline='';el.style.backgroundColor='';}),5000);};window.showPageInfo=function(){alert(`Page: ${d.title}\nURL: ${location.href}\nForms: ${d.forms.length}\nInputs: ${d.querySelectorAll('input').length}\nButtons: ${d.querySelectorAll('button,input[type=\"submit\"]').length}`);};window.findButtons=function(){d.querySelectorAll('button,input[type=\"submit\"],input[type=\"button\"]').forEach(btn=>{btn.style.border='3px solid #f39c12';btn.style.boxShadow='0 0 10px rgba(243,156,18,0.5)';});setTimeout(()=>d.querySelectorAll('button,input[type=\"submit\"],input[type=\"button\"]').forEach(btn=>{btn.style.border='';btn.style.boxShadow='';}),5000);};window.exportPageData=function(){var data=`Page Title: ${d.title}\nURL: ${location.href}\nTimestamp: ${new Date()}\n\n`;var tables=d.querySelectorAll('table');tables.forEach((table,i)=>{data+=`Table ${i+1}:\n`;table.querySelectorAll('tr').forEach(row=>{var cells=Array.from(row.querySelectorAll('td,th')).map(cell=>cell.textContent.trim()).join(' | ');if(cells)data+=cells+'\n';});data+='\n';});var blob=new Blob([data],{type:'text/plain'});var url=URL.createObjectURL(blob);var a=d.createElement('a');a.href=url;a.download=`caim_export_${new Date().getTime()}.txt`;a.click();};})();" class="bookmarklet-link">Quick Actions Panel</a>
            </div>

            <div class="bookmarklet-section">
                <h2>üîß Form Auto-Filler</h2>
                <p>Helps fill out common forms with predefined values and shortcuts for repetitive tasks.</p>
                <a href="javascript:(function(){var d=document,f=d.createElement('div');f.innerHTML='<div style=\"position:fixed;top:100px;right:50px;background:white;border:2px solid #e67e22;border-radius:10px;padding:20px;z-index:10000;box-shadow:0 4px 20px rgba(0,0,0,0.3);font-family:Arial,sans-serif;width:350px;\"><h3 style=\"margin:0 0 15px 0;color:#d35400;\">üîß Form Auto-Filler</h3><div style=\"margin-bottom:10px;\"><label style=\"display:block;margin-bottom:5px;font-weight:bold;\">Username:</label><input type=\"text\" id=\"fillUsername\" placeholder=\"Enter username\" style=\"width:100%;padding:6px;border:1px solid #ccc;border-radius:4px;\"></div><div style=\"margin-bottom:10px;\"><label style=\"display:block;margin-bottom:5px;font-weight:bold;\">Action:</label><select id=\"fillAction\" style=\"width:100%;padding:6px;border:1px solid #ccc;border-radius:4px;\"><option value=\"unlock\">Unlock Account</option><option value=\"reset\">Reset Password</option><option value=\"enable\">Enable Account</option><option value=\"disable\">Disable Account</option></select></div><div style=\"margin-bottom:15px;\"><button onclick=\"fillCurrentForm()\" style=\"background:#e67e22;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;margin-right:5px;\">Fill Form</button><button onclick=\"findFormFields()\" style=\"background:#3498db;color:white;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;\">Find Fields</button></div><button onclick=\"this.parentNode.remove()\" style=\"background:#e74c3c;color:white;border:none;padding:6px 12px;border-radius:5px;cursor:pointer;font-size:12px;\">Close</button><div id=\"fillResults\" style=\"margin-top:10px;font-size:12px;color:#666;\"></div></div>';d.body.appendChild(f);window.fillCurrentForm=function(){var username=d.getElementById('fillUsername').value;var action=d.getElementById('fillAction').value;var results=d.getElementById('fillResults');if(!username){results.innerHTML='<span style=\"color:red;\">Please enter a username</span>';return;}var filled=0;d.querySelectorAll('input[type=\"text\"],input[type=\"search\"]').forEach(input=>{if(input.name.toLowerCase().includes('user')||input.placeholder.toLowerCase().includes('user')||input.id.toLowerCase().includes('user')){input.value=username;input.style.backgroundColor='#d5f4e6';filled++;}});d.querySelectorAll('select').forEach(select=>{Array.from(select.options).forEach(option=>{if(option.text.toLowerCase().includes(action)||option.value.toLowerCase().includes(action)){select.value=option.value;select.style.backgroundColor='#d5f4e6';filled++;}});});results.innerHTML=`Filled ${filled} fields with username: ${username} and action: ${action}`;setTimeout(()=>d.querySelectorAll('input,select').forEach(el=>el.style.backgroundColor=''),3000);};window.findFormFields=function(){var results=d.getElementById('fillResults');var fields=[];d.querySelectorAll('input,select,textarea').forEach(field=>{var info=`${field.tagName}: ${field.name||field.id||'unnamed'} (${field.type||'select'})`;field
